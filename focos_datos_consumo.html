<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Metadatos -->
    <meta charset="UTF-8">
    <meta name="author" content="Haskutani">
    <meta name="description" content="Proyecto Haskutami INNOVATEC">
    <meta name="keywords" content="HTML, CSS, JavaScript, React">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Título -->
    <title>Ambe soluciones inteligentes</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="images/icon.png">
    <!-- Estilos propios -->
    <link href="style.css" rel="stylesheet">
    <link href="style_focos.css" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- script necesario para el navBar -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <nav class="navbar fixed-top mb-3">
        <div class="container-fluid">
            <!-- logo -->
            <!-- Logo en pantallas medianas y más grandes: imagen del logo -->
            <a class="navbar-brand d-md-block d-none" href="#">
                <img src="images/logo-lg.png" alt="Bootstrap" width="auto" height="50">
            </a>
            <!-- Logo en pantallas pequeñas y extra pequeñas: imagen del logo -->
            <a class="navbar-brand d-md-none d-block" href="#">
                <img src="images/logo-sm.png" alt="Bootstrap" width="auto" height="50">
            </a>
            
            <!-- toggle button -->
            <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
          
            <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
                <div class="offcanvas-header">
                    <!-- título del canvas del toggle -->
                    <a class="nav-link active text-custom-yellow-non" aria-current="page" href="perfil.html" id="perfil">
                        <h5><i class="bi bi-person-circle"></i> Mi perfil</h5>
                    </a>
                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>

                <div class="offcanvas-body">
                    <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                        <li class="nav-item">
                            <a class="nav-link active text-custom-yellow-non" aria-current="page" href="focos.html"><i class="bi bi-house-door-fill" id="inicio"></i> Inicio</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-custom-yellow-non" href="focos_dispositivos.html"><i class="bi bi-lightbulb" id="dispositivos"></i> Dispositivos</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-custom-yellow-active" href="focos_datos_consumo.html"><i class="bi bi-plug" id="datos"></i> Datos de Consumo</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <div id="userInfo"></div>

    <!-- ya el cuerpo de la chingadera -->
    <div class="container mt-5 pt-5">
        <h2 class="text-center" style="color: #a49e9e;">Datos de Consumo</h2>

        <!-- Formulario para ingresar datos -->
        <form id="dataForm" class="mt-4">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="watts" class="form-label">Watts:</label>
                    <input type="number" class="form-control" id="watts" placeholder="Ingrese los watts">
                </div>
                <div class="col-md-6 mb-3">
                    <label for="gasto" class="form-label">Gasto Monetario:</label>
                    <input type="number" class="form-control" id="gasto" placeholder="Ingrese el gasto monetario">
                </div>
                <div class="col-md-6 mb-3">
                    <label for="fechaInicio" class="form-label">Fecha de Inicio:</label>
                    <input type="date" class="form-control" id="fechaInicio">
                </div>
                <div class="col-md-6 mb-3">
                    <label for="fechaCorte" class="form-label">Fecha de Corte:</label>
                    <input type="date" class="form-control" id="fechaCorte">
                </div>
                <div class="col-md-6 mb-3">
                    <label for="porcentajeConsumo" class="form-label">Porcentaje de Consumo:</label>
                    <input type="number" class="form-control" id="porcentajeConsumo" placeholder="Ingrese el porcentaje de consumo">
                </div>
            </div>
            <button type="button" class="btn btn-primary" onclick="updateChart()">Actualizar Gráfica</button>
        </form>

        <!-- Gráfica -->
        <div class="mt-5">
            <canvas id="consumoChart"></canvas>
        </div>

        <!-- Gráfica Circular -->
        <div class="mt-5">
            <canvas id="circularChart"></canvas>
        </div>
    </div>

    <!--Script Focos-->
    <!-- <script type="module" src="scripts/Foco.js"></script> -->
    <!-- Bootstrap JS y dependencias -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12lHcf6riP93MBQkKbnqCq4G9YdM/3uw7gBPct4d6CxB2n6L" crossorigin="anonymous"></script>
   
    <!-- Script para Chart.js esta es una libreria para que la grafica funcione-->
    <script>
        // aquí se inicializa la grafica
        const ctx = document.getElementById('consumoChart').getContext('2d');
        const consumoChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [], // Aquí veo las fechas
                datasets: [{
                    label: 'Watts',
                    data: [],
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2,
                    fill: false
                }, {
                    label: 'Gasto Monetario',
                    data: [],
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 2,
                    fill: false
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Fecha'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Consumo'
                        }
                    }
                }
            }
        });

        // Gráfica Circular
        const ctxCircular = document.getElementById('circularChart').getContext('2d');
        const circularChart = new Chart(ctxCircular, {
            type: 'doughnut',
            data: {
                labels: ['Consumo', 'Restante'],
                datasets: [{
                    data: [0, 100], // Datos iniciales
                    backgroundColor: [
                        'rgba(240, 192, 0, 0.8)', // Amarillo
                        'rgba(169, 169, 169, 0.6)' // Gris
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '50%', // Para crear el hueco en medio
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Porcentaje de Consumo de Luz'
                    }
                }
            }
        });

        function updateChart() {
            const watts = document.getElementById('watts').value;
            const gasto = document.getElementById('gasto').value;
            const fechaInicio = document.getElementById('fechaInicio').value;
            const fechaCorte = document.getElementById('fechaCorte').value;
            const porcentajeConsumo = document.getElementById('porcentajeConsumo').value;

            // Aqui actualizo los datos de la grafica
            consumoChart.data.labels = [fechaInicio, fechaCorte];
            consumoChart.data.datasets[0].data = [0, watts];
            consumoChart.data.datasets[1].data = [0, gasto];
            consumoChart.update();

            // Actualizar la gráfica circular
            circularChart.data.datasets[0].data = [porcentajeConsumo, 100 - porcentajeConsumo];
            circularChart.update();
        }
    </script>
</body>
</html>
